<html>
    <head>

    <script src="/scripts/jquery-1.7.2.min.js"></script>
    <script src="scripts/datajs-1.0.3.js"></script>
    <script src="/scripts/jaydata/jaydata.js"></script>
    <script src="scripts/jaydata/jaydataproviders/oDataProvider.js"></script>
    <script src="/scripts/JaySvcUtil.js"></script>
    <script src="scripts/knockout-2.1.0.debug.js"></script>
    <script src="scripts/jaydata/jaydatamodules/knockout.js"></script>
    <script src="scripts/application.js"></script>
    </head>
<body>
    <div id="output">

    </div>

    <div id="UserGroupAdminUI">
    <div id="manageGroupsUI">
        <table border="1">
            <thead>
            <tr data-bind="with: newGroupModel">
                <th>Name</th>
                <th><a href="#" data-bind="click: show">add group</a></th>
            </tr>
            </thead>
            <tbody data-bind="foreach: groups">
            <tr>
                <td data-bind="text: name"></td>
                <td> <a href="#" data-bind="click: $root.removeGroup">remove</a></td>
            </tr>
            </tbody>
        </table>
    </div>


    <div id="addGroupUI" data-bind="visible: visible"  style="border:1px solid red">
        <title>Add group</title>
        <form data-bind="submit: createGroup">
            Name: <input data-bind="value: name" /><br />
            <input type="submit" value="Create Group"/>
            <input type="checkbox" data-bind="checked: closeOnCreate" /> Close when created
        </form>
    </div>

        <script type="text/html" id="Edm.String">
            <div data-bind="text: $data"  />
        </script>


        <script type="text/html" id="Edm.String-editor">
            <div data-bind="text: $data.getType().fullName" />
            <input data-bind="value: $parent[$data.name] " />
        </script>

        <script type="text/html" id="Edm.Boolean-editor">
            <input type="checkbox" data-bind="checked: $parent[$data.name]" />
        </script>

        <script type="text/html" id="Edm.DateTime-editor">
            <input type="date" data-bind="value: $parent[$data.name]" />
        </script>

        <!--<script type="text/html" id="property-editor">-->
            <!--<div data-bind="text: $data.name"></div>-->
            <!--<div data-bind="text: $data.value"></div>-->

            <!--<div data-bind="{template:  $data.value.getType().memberDefinitions.getMember($data.name).type +'-editor', data: $data.value}"></div>-->
            <!--&lt;!&ndash;<div data-bind="template: {name: $data.value.getType().memberDefinitions.getMember($data.name+'-editor').type, data: $data.value[$data.name]}" ></div>-->
            <!--&lt;!&ndash;<div data-bind="template: {name: $data.value.getType().memberDefinitions.getMember($data.name+'-editor').type, data: $data.value[$data.name]}" ></div>&ndash;&gt;-->
        <!--</script>-->
        <script type="text/html" id="debug">
            Debug: !<div data-bind="text: $data"></div>!
        </script>
        <script type="text/html" id="object-property-editor-working">
            <div data-bind="text: $data.name"></div>
            <div data-bind="text: $data.templateName = $data.type + '-editor'"></div>
            <div data-bind="{ template: $data.type+'-editor', data: $parent[$data.name]}" ></div>
        </script>

        <script type="text/html" id="object-property-editor">
            <div data-bind="text: $data.name"></div>
            <!--<div data-bind="{ template: $data.type+'-editor', data: $parent[$data.name]}" ></div>-->
            <div data-bind="template: { name: $data.type + '-editor', data: $data.name}" ></div>
        </script>


        <script type="text/html" id="object-editor">
            <div data-bind="template:{name: 'object-property-editor',
                        foreach: $data.innerInstance.getType().memberDefinitions.getPublicMappedProperties() }">
            </div>
        </script>


        <div id="addUserUI" data-bind="visible: visible">
            <form data-bind="submit: createUser">
                <fieldset data-bind="with: $root.user">
                    <div data-bind="template: { name: 'object-editor'}"></div>
                    <input type="submit" value="Create user"/>
                </fieldset>
            </form>
        </div>

        <div id="adminUI">
        <div>
            <span>Users: <span data-bind="text: userCount"></span></span>
        </div>
        <table>
            <thead>
            <tr>
                <td>!!!!!</td>
                <th>Login name</th>
                <th>Firstname</th>
                <th>Lastname</th>
                <th>Enabled</th>
                <th data-bind="with:newUserModel"><a href="#" data-bind="click: show">Add user</a></th>
            </tr>
            </thead>
            <tbody data-bind="foreach: userList">
            <tr>
                <!--<td data-bind="template:{name: 'object-properties', data: $data}"></td>-->
                <!-- , click: $root.loadProducts-->
                <td data-bind="template: { name: 'Edm.String', data: login }"></td>
                <td data-bind="text: $data['firstName']"></td>
                <td data-bind="text: lastName"></td>
                <td data-bind="text: enabled"></td>
                <td><a href="#" data-bind="text: 'Remove', click: $root.removeUser"></a>, <a href="#" data-bind="text: 'SetPassword', click: $root.changePassword"></a></td>
            </tr>
            </tbody>
        </table>
        <form data="submit:">

        </form>
    </div>


    <div data-bind="visible: $root.user" id="changePasswordUI">
        <form data-bind="submit: changePassword">
            <div data-bind="with: $root.user">
                <span data-bind="text: login"></span> (Id: <span data-bind="text: Id"></span>)
            </div>
            <input type="password" data-bind="value: password" />
            <input type="password" data-bind="value: password2" />
            <input type="submit" value="Set Password"/>
            <div data-bind="text: progressText"></div>
        </form>
    </div>
    </div>

    <div id="DatabasesAdminUI">
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th></th>
                </tr>
            </thead>
            <tbody data-bind="foreach:databases">
                <tr>
                    <td data-bind="text: name" />
                    <td><a href="#" data-bind="click: manage"></a></td>
                </tr>
            </tbody>
        </table>
    </div>

    <div id="StringEditor">
        <input data-bind="$data" />
    </div>
    <div id="AddDatabase">

    </div>

</body>
</html>